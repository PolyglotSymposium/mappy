if = \cond (then) (else) -> [[
  default-take [take :truthy cond] (:false else) then
]]

true = (:truthy :true)
false = (:truthy :false)

zero = ()

empty? = \map -> [default-take map (() true) false]

succ = \num -> [give :pred num ()]

pred = \num -> [take :pred num]

add = \a b -> [
  if [empty? a]
    b
    [succ [add [pred a] b]]
]

test = \map -> [default-take :end map [test [take :next map]]]

test-value = (:next (:next (:end :done)))

two = [succ [succ zero]]

identity = \a -> a

main = [add two two]
